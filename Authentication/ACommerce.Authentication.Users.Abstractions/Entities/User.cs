// Entities/User.cs
using System.ComponentModel.DataAnnotations.Schema;

namespace ACommerce.Authentication.Users.Abstractions.Entities;

/// <summary>
/// ???????? ??????? ????????
/// </summary>
public class User : IBaseEntity
{
	public Guid Id { get; set; }
	public DateTime CreatedAt { get; set; }
	public DateTime? UpdatedAt { get; set; }
	public bool IsDeleted { get; set; }

	/// <summary>
	/// ???? ???????? ?????? (??????? ?? ?? ???????? ??????)
	/// </summary>
	public required string UserId { get; init; }

	/// <summary>
	/// ??? ????????
	/// </summary>
	public required string Username { get; set; }

	/// <summary>
	/// ?????? ?????????? (????????)
	/// </summary>
	public required string Email { get; set; }

	/// <summary>
	/// ??? ?????? (???????? ? 2FA)
	/// </summary>
	public string? PhoneNumber { get; set; }

	/// <summary>
	/// ???? ?????? ???????
	/// </summary>
	public required string PasswordHash { get; set; }

	/// <summary>
	/// ?? ?? ?????? ?? ?????? ???????????
	/// </summary>
	public bool EmailVerified { get; set; }

	/// <summary>
	/// ?? ?? ?????? ?? ??? ???????
	/// </summary>
	public bool PhoneNumberVerified { get; set; }

	/// <summary>
	/// ?? ????? ???????? ?????????
	/// </summary>
	public bool TwoFactorEnabled { get; set; }

	/// <summary>
	/// ????? ???????? ???????? ???????
	/// </summary>
	public TwoFactorMethod? PreferredTwoFactorMethod { get; set; }

	/// <summary>
	/// ?? ?????? ????
	/// </summary>
	public bool IsActive { get; set; } = true;

	/// <summary>
	/// ?? ?????? ?????
	/// </summary>
	public bool IsLocked { get; set; }

	/// <summary>
	/// ??? ?????? ?????
	/// </summary>
	public DateTimeOffset? LockoutEnd { get; set; }

	/// <summary>
	/// ??? ??????? ?????? ???????
	/// </summary>
	public int AccessFailedCount { get; set; }

	/// <summary>
	/// ??? ????? ????
	/// </summary>
	public DateTimeOffset? LastLoginAt { get; set; }

	/// <summary>
	/// ??????? ???????? ?????????
	/// </summary>
	public List<UserRole> UserRoles { get; init; } = new();

	/// <summary>
	/// Claims ????????
	/// </summary>
	public List<UserClaim> UserClaims { get; init; } = new();

	/// <summary>
	/// ??????? ??????
	/// </summary>
	[NotMapped]
	public Dictionary<string, string> Metadata { get; init; } = new();
}

/// <summary>
/// ??? ???????? ????????
/// </summary>
public enum TwoFactorMethod
{
	SMS = 1,
	Email = 2,
	Nafath = 3,
	AuthenticatorApp = 4
}

