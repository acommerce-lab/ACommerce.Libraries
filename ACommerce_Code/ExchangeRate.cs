using ACommerce.SharedKernel.Abstractions.Entities;

namespace ACommerce.Catalog.Currencies.Entities;

/// <summary>
/// ??? ??? ??? ??????
/// </summary>
public class ExchangeRate : IBaseEntity
{
	public Guid Id { get; set; }
	public DateTime CreatedAt { get; set; }
	public DateTime? UpdatedAt { get; set; }
	public bool IsDeleted { get; set; }

	/// <summary>
	/// ?????? ??????
	/// </summary>
	public Guid FromCurrencyId { get; set; }
	public Currency? FromCurrency { get; set; }

	/// <summary>
	/// ?????? ?????
	/// </summary>
	public Guid ToCurrencyId { get; set; }
	public Currency? ToCurrency { get; set; }

	/// <summary>
	/// ??? ?????
	/// ????: 1 SAR = 0.27 USD ? Rate = 0.27
	/// </summary>
	public decimal Rate { get; set; }

	/// <summary>
	/// ????? ?????? (??????)
	/// ????: 1 USD = 3.75 SAR ? InverseRate = 3.75
	/// </summary>
	public decimal InverseRate { get; set; }

	/// <summary>
	/// ????? ????? ???????
	/// </summary>
	public DateTime EffectiveDate { get; set; }

	/// <summary>
	/// ????? ???????? (null = ?? ?????)
	/// </summary>
	public DateTime? ExpiryDate { get; set; }

	/// <summary>
	/// ?????? (???: ????? ??????? ???????? European Central Bank)
	/// </summary>
	public string? Source { get; set; }

	/// <summary>
	/// ???????? (??? ??? ???? ???? ?? ??? ??? ???)
	/// </summary>
	public int Priority { get; set; }

	/// <summary>
	/// ??? ????? (????? ??? ?????? ????? ??????? ???)
	/// </summary>
	public string RateType { get; set; } = "official";

	/// <summary>
	/// ?? ?? ??? ???? ?? ??????
	/// </summary>
	public bool IsFixed { get; set; }

	/// <summary>
	/// ??????? ??????
	/// </summary>
	public Dictionary<string, string> Metadata { get; set; } = new();

	/// <summary>
	/// ???? ????? ?????? ????????
	/// </summary>
	public void CalculateInverseRate()
	{
		if (Rate > 0)
		{
			InverseRate = 1 / Rate;
		}
	}
}

