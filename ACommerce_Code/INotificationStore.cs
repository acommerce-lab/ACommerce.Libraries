using ACommerce.Notifications.Abstractions.Models;

namespace ACommerce.Notifications.Core.Storage;

/// <summary>
/// ????? ?????? ????????? (????????)
/// ???? ??????? ???????? Database, Redis, etc.
/// </summary>
public interface INotificationStore
{
	/// <summary>
	/// ??? ?????
	/// </summary>
	Task<Guid> SaveNotificationAsync(
		Notification notification,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ????? ???? ?????
	/// </summary>
	Task UpdateNotificationAsync(
		Notification notification,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ?????? ??? ????? ?????? ??????
	/// </summary>
	Task<Notification?> GetNotificationByIdAsync(
		Guid notificationId,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ?????? ??? ????????? ???? ????? ????? ??????
	/// </summary>
	Task<List<Notification>> GetNotificationsForRetryAsync(
		int batchSize,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ?????? ??? ????????? ???????? ???? ??? ??? ???????
	/// </summary>
	Task<List<Notification>> GetScheduledNotificationsAsync(
		int batchSize,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ?????? ??? ??????? ?????? ????
	/// </summary>
	Task<List<Notification>> GetUserNotificationsAsync(
		string userId,
		int count,
		int skip = 0,
		CancellationToken cancellationToken = default);

	/// <summary>
	/// ??? ????????? ???????
	/// </summary>
	Task CleanupOldNotificationsAsync(
		TimeSpan maxAge,
		CancellationToken cancellationToken = default);
}

