@page "/"
@inject AdminApiService ApiService

<div class="dashboard-page">
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon primary">ğŸ‘¥</div>
            <div class="stat-content">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                <div class="value">@Stats.TotalUsers.ToString("N0")</div>
                <div class="change positive">+@Stats.NewUsersThisMonth Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon success">ğŸ¢</div>
            <div class="stat-content">
                <h3>Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù†Ø´Ø·Ø©</h3>
                <div class="value">@Stats.TotalListings.ToString("N0")</div>
                <div class="change warning">@Stats.PendingListings Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon warning">ğŸ“¦</div>
            <div class="stat-content">
                <h3>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                <div class="value">@Stats.TotalOrders.ToString("N0")</div>
                <div class="change positive">+@Stats.OrdersThisMonth Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon danger">ğŸ’°</div>
            <div class="stat-content">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
                <div class="value">@Stats.TotalRevenue.ToString("N0") Ø±.Ø³</div>
                <div class="change positive">@Stats.ActiveVendors Ø¨Ø§Ø¦Ø¹ Ù†Ø´Ø·</div>
            </div>
        </div>
    </div>

    <div class="content-grid">
        <div class="card">
            <div class="card-header">
                <h2>ğŸ“ˆ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h2>
            </div>
            <div class="card-body">
                <SfChart Height="300px">
                    <ChartPrimaryXAxis ValueType="Syncfusion.Blazor.Charts.ValueType.Category" />
                    <ChartPrimaryYAxis LabelFormat="{value} Ø±.Ø³" />
                    <ChartSeriesCollection>
                        <ChartSeries DataSource="@ChartData" 
                                     XName="Label" 
                                     YName="Value" 
                                     Type="ChartSeriesType.Column"
                                     Fill="#2563eb">
                            <ChartCornerRadius TopLeft="4" TopRight="4" />
                        </ChartSeries>
                    </ChartSeriesCollection>
                    <ChartTooltipSettings Enable="true" />
                </SfChart>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2>ğŸ“¦ Ø¢Ø®Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
                <a href="/orders" class="view-all">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a>
            </div>
            <div class="card-body">
                @foreach (var order in RecentOrders)
                {
                    <div class="order-item">
                        <div class="order-info">
                            <span class="order-id">@order.Id</span>
                            <span class="order-customer">@order.CustomerName</span>
                        </div>
                        <div class="order-amount">@order.Amount.ToString("N0") Ø±.Ø³</div>
                        <span class="status-badge @GetStatusClass(order.Status)">@order.Status</span>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@code {
    private DashboardStats Stats { get; set; } = new();
    private List<RecentOrder> RecentOrders { get; set; } = new();
    private List<ChartDataPoint> ChartData { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        Stats = await ApiService.GetDashboardStatsAsync();
        RecentOrders = await ApiService.GetRecentOrdersAsync(5);
        ChartData = await ApiService.GetSalesChartDataAsync();
    }

    private string GetStatusClass(string status) => status switch
    {
        "Ù…ÙƒØªÙ…Ù„" => "success",
        "Ø¬Ø¯ÙŠØ¯" => "primary",
        "Ù‚ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„" or "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©" => "warning",
        "Ù…Ù„ØºÙŠ" => "danger",
        _ => "primary"
    };
}
