@namespace ACommerce.Templates.Customer.Components

@if (IsBlocked)
{
    <div class="ac-version-blocker">
        <div class="ac-version-blocker-overlay"></div>
        <div class="ac-version-blocker-content">
            <div class="ac-version-blocker-icon">
                <i class="bi bi-exclamation-octagon-fill"></i>
            </div>

            <h1 class="ac-version-blocker-title">
                @(IsArabic ? "إصدار غير مدعوم" : "Unsupported Version")
            </h1>

            <p class="ac-version-blocker-message">
                @(string.IsNullOrEmpty(Message)
                    ? (IsArabic
                        ? "إصدارك الحالي غير مدعوم. يجب التحديث للاستمرار في استخدام التطبيق."
                        : "Your current version is no longer supported. Please update to continue using the app.")
                    : Message)
            </p>

            @if (!string.IsNullOrEmpty(CurrentVersion) || !string.IsNullOrEmpty(LatestVersion))
            {
                <div class="ac-version-blocker-versions">
                    @if (!string.IsNullOrEmpty(CurrentVersion))
                    {
                        <div class="ac-version-blocker-version">
                            <span class="ac-version-blocker-version-label">@(IsArabic ? "إصدارك:" : "Your version:")</span>
                            <span class="ac-version-blocker-version-value ac-version-old">@CurrentVersion</span>
                        </div>
                    }
                    @if (!string.IsNullOrEmpty(LatestVersion))
                    {
                        <div class="ac-version-blocker-version">
                            <span class="ac-version-blocker-version-label">@(IsArabic ? "أحدث إصدار:" : "Latest version:")</span>
                            <span class="ac-version-blocker-version-value ac-version-new">@LatestVersion</span>
                        </div>
                    }
                </div>
            }

            @if (!string.IsNullOrEmpty(ReleaseNotes))
            {
                <div class="ac-version-blocker-notes">
                    <h3>@(IsArabic ? "ما الجديد؟" : "What's New?")</h3>
                    <p>@ReleaseNotes</p>
                </div>
            }

            <div class="ac-version-blocker-actions">
                @if (!string.IsNullOrEmpty(UpdateUrl))
                {
                    <a href="@UpdateUrl" class="ac-version-blocker-btn ac-version-blocker-btn-primary" target="_blank">
                        <i class="bi bi-download"></i>
                        @(IsArabic ? "تحديث الآن" : "Update Now")
                    </a>
                }

                @if (!string.IsNullOrEmpty(StoreUrl))
                {
                    <a href="@StoreUrl" class="ac-version-blocker-btn ac-version-blocker-btn-secondary" target="_blank">
                        <i class="bi bi-shop"></i>
                        @(IsArabic ? "فتح المتجر" : "Open Store")
                    </a>
                }
            </div>

            @if (!string.IsNullOrEmpty(SupportEmail) || !string.IsNullOrEmpty(SupportUrl))
            {
                <div class="ac-version-blocker-support">
                    <p>@(IsArabic ? "تحتاج مساعدة؟" : "Need help?")</p>
                    @if (!string.IsNullOrEmpty(SupportEmail))
                    {
                        <a href="mailto:@SupportEmail">@SupportEmail</a>
                    }
                    @if (!string.IsNullOrEmpty(SupportUrl))
                    {
                        <a href="@SupportUrl" target="_blank">@(IsArabic ? "تواصل معنا" : "Contact us")</a>
                    }
                </div>
            }
        </div>
    </div>
}

@code {
    /// <summary>
    /// هل التطبيق محظور؟
    /// </summary>
    [Parameter] public bool IsBlocked { get; set; }

    /// <summary>
    /// الرسالة المخصصة
    /// </summary>
    [Parameter] public string? Message { get; set; }

    /// <summary>
    /// الإصدار الحالي
    /// </summary>
    [Parameter] public string? CurrentVersion { get; set; }

    /// <summary>
    /// أحدث إصدار متاح
    /// </summary>
    [Parameter] public string? LatestVersion { get; set; }

    /// <summary>
    /// ملاحظات الإصدار
    /// </summary>
    [Parameter] public string? ReleaseNotes { get; set; }

    /// <summary>
    /// رابط التحديث
    /// </summary>
    [Parameter] public string? UpdateUrl { get; set; }

    /// <summary>
    /// رابط المتجر (App Store / Google Play)
    /// </summary>
    [Parameter] public string? StoreUrl { get; set; }

    /// <summary>
    /// بريد الدعم
    /// </summary>
    [Parameter] public string? SupportEmail { get; set; }

    /// <summary>
    /// رابط صفحة الدعم
    /// </summary>
    [Parameter] public string? SupportUrl { get; set; }

    /// <summary>
    /// هل اللغة العربية؟
    /// </summary>
    [Parameter] public bool IsArabic { get; set; } = true;

    public void Block()
    {
        IsBlocked = true;
        StateHasChanged();
    }

    public void Unblock()
    {
        IsBlocked = false;
        StateHasChanged();
    }
}
