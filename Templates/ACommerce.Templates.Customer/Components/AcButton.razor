@namespace ACommerce.Templates.Customer.Components

<button class="@CssClass"
        type="@Type"
        disabled="@(Disabled || Loading)"
        @onclick="OnClick"
        @attributes="AdditionalAttributes">
    @if (Loading)
    {
        <span class="ac-btn-spinner"></span>
    }
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == ButtonIconPosition.Start)
    {
        <i class="@Icon"></i>
    }
    @if (ChildContent != null)
    {
        @ChildContent
    }
    else if (!string.IsNullOrEmpty(Text))
    {
        <span>@Text</span>
    }
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == ButtonIconPosition.End)
    {
        <i class="@Icon"></i>
    }
</button>

@code {
    [Parameter] public string? Text { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public ButtonVariant Variant { get; set; } = ButtonVariant.Primary;
    [Parameter] public ButtonSize Size { get; set; } = ButtonSize.Medium;
    [Parameter] public string Type { get; set; } = "button";
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public bool Loading { get; set; }
    [Parameter] public bool Block { get; set; }
    [Parameter] public bool Outline { get; set; }
    [Parameter] public string? Icon { get; set; }
    [Parameter] public ButtonIconPosition IconPosition { get; set; } = ButtonIconPosition.Start;
    [Parameter] public EventCallback<MouseEventArgs> OnClick { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private string CssClass
    {
        get
        {
            var classes = new List<string> { "ac-btn" };

            // Variant
            var variantClass = Outline ? $"ac-btn-outline-{Variant.ToString().ToLower()}"
                                       : $"ac-btn-{Variant.ToString().ToLower()}";
            classes.Add(variantClass);

            // Size
            if (Size != ButtonSize.Medium)
            {
                classes.Add($"ac-btn-{Size.ToString().ToLower()}");
            }

            // Block
            if (Block)
            {
                classes.Add("ac-btn-block");
            }

            // Loading
            if (Loading)
            {
                classes.Add("ac-btn-loading");
            }

            // Custom class
            if (!string.IsNullOrEmpty(Class))
            {
                classes.Add(Class);
            }

            return string.Join(" ", classes);
        }
    }
}
