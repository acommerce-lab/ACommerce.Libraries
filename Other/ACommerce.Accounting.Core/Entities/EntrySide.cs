using ACommerce.Catalog.Currencies.Entities;
using ACommerce.Catalog.Units.Entities;
using ACommerce.SharedKernel.Abstractions.Entities;

namespace ACommerce.Accounting.Core.Entities;

/// <summary>
/// ??? ????? ???????? (?????? - ????? ???????!)
/// ?? ??? ????? ???: ???? + ????/???? + ????/????
/// </summary>
public class EntrySide : IBaseEntity
{
	public Guid Id { get; set; }
	public DateTime CreatedAt { get; set; }
	public DateTime? UpdatedAt { get; set; }
	public bool IsDeleted { get; set; }

	/// <summary>
	/// ???? ?????
	/// </summary>
	public Guid EntryId { get; set; }
	public AccountingEntry? Entry { get; set; }

	/// <summary>
	/// ??? ?????/???????
	/// </summary>
	public int LineNumber { get; set; }

	/// <summary>
	/// ???? ??????
	/// </summary>
	public Guid AccountId { get; set; }
	public Account? Account { get; set; }

	// ====================================================================================
	// ????? ?????: ?????? (Currency Dimension)
	// ====================================================================================

	/// <summary>
	/// ???? ??????
	/// </summary>
	public Guid? CurrencyId { get; set; }
	public Currency? Currency { get; set; }

	/// <summary>
	/// ?????? ??????
	/// </summary>
	public decimal? DebitAmount { get; set; }

	/// <summary>
	/// ?????? ??????
	/// </summary>
	public decimal? CreditAmount { get; set; }

	/// <summary>
	/// ??? ????? (??? ???? ?????? ??? ?????? ????????)
	/// </summary>
	public decimal? ExchangeRate { get; set; }

	/// <summary>
	/// ?????? ??????? ???????? (?????)
	/// </summary>
	public decimal? BaseDebitAmount { get; set; }

	/// <summary>
	/// ?????? ??????? ???????? (?????)
	/// </summary>
	public decimal? BaseCreditAmount { get; set; }

	// ====================================================================================
	// ????? ??????: ????? (Unit Dimension)
	// ====================================================================================

	/// <summary>
	/// ???? ??????
	/// </summary>
	public Guid? UnitId { get; set; }
	public Unit? Unit { get; set; }

	/// <summary>
	/// ?????? ???????
	/// </summary>
	public decimal? DebitQuantity { get; set; }

	/// <summary>
	/// ?????? ???????
	/// </summary>
	public decimal? CreditQuantity { get; set; }

	// ====================================================================================
	// ????? ??????: ???? ??????? (Cost Center Dimension)
	// ====================================================================================

	/// <summary>
	/// ???? ???? ???????
	/// </summary>
	public Guid? CostCenterId { get; set; }
	public CostCenter? CostCenter { get; set; }

	// ====================================================================================
	// ????? ??????: ???????? ???????? (Additional Dimensions)
	// ====================================================================================

	/// <summary>
	/// ???? ??????? (????????? ???? ????? ?????? ??????)
	/// </summary>
	public Guid? ProjectId { get; set; }

	/// <summary>
	/// ???? ?????
	/// </summary>
	public Guid? DepartmentId { get; set; }

	/// <summary>
	/// ?????? ???????? ???? ?????
	/// </summary>
	public string? Description { get; set; }

	/// <summary>
	/// ??????? ??????
	/// </summary>
	public Dictionary<string, string> Metadata { get; set; } = new();

	/// <summary>
	/// ?????? ??? ???? ?????? (???? - ????)
	/// </summary>
	public decimal GetNetAmount()
	{
		return (DebitAmount ?? 0) - (CreditAmount ?? 0);
	}

	/// <summary>
	/// ?????? ??? ???? ?????? (???? - ????)
	/// </summary>
	public decimal GetNetQuantity()
	{
		return (DebitQuantity ?? 0) - (CreditQuantity ?? 0);
	}
}

