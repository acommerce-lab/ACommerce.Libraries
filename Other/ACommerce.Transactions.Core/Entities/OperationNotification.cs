using System.ComponentModel.DataAnnotations.Schema;
using ACommerce.Transactions.Core.Enums;
using ACommerce.SharedKernel.Abstractions.Entities;
using ACommerce.Transactions.Core.Enums;
using System.ComponentModel.DataAnnotations.Schema;

namespace ACommerce.Transactions.Core.Entities;

/// <summary>
/// ??????? ??????? ?????? ??? ?????
/// </summary>
public class OperationNotification : IBaseEntity
{
	public Guid Id { get; set; }
	public DateTime CreatedAt { get; set; }
	public DateTime? UpdatedAt { get; set; }
	public bool IsDeleted { get; set; }

	/// <summary>
	/// ???? ???????
	/// </summary>
	public Guid OperationId { get; set; }
	public DocumentOperation? Operation { get; set; }

	/// <summary>
	/// ??? ???????
	/// </summary>
	public NotificationType Type { get; set; }

	/// <summary>
	/// ?????? (Template)
	/// ???? ?? ????? ??? placeholders ???: {DocumentNumber}, {UserName}, {Date}
	/// </summary>
	public required string Template { get; set; }

	/// <summary>
	/// ??????? (?????? ??????????)
	/// </summary>
	public string? Subject { get; set; }

	/// <summary>
	/// ??????????
	/// ???? ?? ????:
	/// - Roles: ["admin", "manager"]
	/// - Users: ["user-id-1", "user-id-2"]
	/// - Dynamic: ["creator", "approver", "assigned_user"]
	/// </summary>
	[NotMapped]
	public List<string> Recipients { get; set; } = new();

	/// <summary>
	/// ???? (CC) - ?????? ??????????
	/// </summary>
	[NotMapped]
	public List<string> CcRecipients { get; set; } = new();

	/// <summary>
	/// ?? ??????? ????
	/// </summary>
	public bool IsActive { get; set; } = true;

	/// <summary>
	/// ??????? (????????) ??? ????? ???????
	/// ???? ????????? ????????
	/// </summary>
	public int? DelayMinutes { get; set; }

	/// <summary>
	/// ????????
	/// </summary>
	public int Priority { get; set; }

	/// <summary>
	/// ??????? ?????? (???: webhook URL? API keys? ???)
	/// </summary>
	[NotMapped]
	public Dictionary<string, string> Metadata { get; set; } = new();
}

