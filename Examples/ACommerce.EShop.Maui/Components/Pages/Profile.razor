@page "/profile"
@using ACommerce.Client.Profiles
@inject ProfilesClient ProfilesClient

<PageTitle>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ - ACommerce Shop</PageTitle>

<h1>ğŸ‘¤ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h1>

@if (isLoading)
{
    <div class="text-center p-3">
        <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
    </div>
}
else
{
    <div class="profile-container">
        <div class="profile-header">
            <div class="avatar">
                <img src="@(profile.AvatarUrl ?? "https://via.placeholder.com/120?text=ğŸ‘¤")" alt="Avatar" />
            </div>
            <div class="profile-info">
                <h2>@profile.DisplayName</h2>
                <p>@profile.Email</p>
            </div>
        </div>

        <div class="profile-form">
            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                <SfTextBox @bind-Value="@profile.FirstName" Placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„" />
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</label>
                <SfTextBox @bind-Value="@profile.LastName" Placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±" />
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <SfTextBox @bind-Value="@profile.Email" Placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" Readonly="true" />
            </div>

            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <SfTextBox @bind-Value="@profile.PhoneNumber" Placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" />
            </div>

            <div class="form-group">
                <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                <SfTextBox @bind-Value="@profile.Address" Placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" Multiline="true" />
            </div>

            <div class="form-actions">
                <SfButton CssClass="e-success" @onclick="SaveProfile">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</SfButton>
            </div>
        </div>

        <div class="profile-stats">
            <div class="stat-item">
                <span class="stat-value">@profile.OrdersCount</span>
                <span class="stat-label">Ø·Ù„Ø¨</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">@profile.WishlistCount</span>
                <span class="stat-label">Ù…ÙØ¶Ù„Ø©</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">@profile.ReviewsCount</span>
                <span class="stat-label">ØªÙ‚ÙŠÙŠÙ…</span>
            </div>
        </div>
    </div>
}

@code {
    private ProfileViewModel profile = new();
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadProfile();
    }

    private async Task LoadProfile()
    {
        isLoading = true;
        try
        {
            // Mock data for demo
            profile = new ProfileViewModel
            {
                FirstName = "Ø£Ø­Ù…Ø¯",
                LastName = "Ù…Ø­Ù…Ø¯",
                DisplayName = "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
                Email = "ahmed@example.com",
                PhoneNumber = "+966 50 123 4567",
                Address = "Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©",
                OrdersCount = 12,
                WishlistCount = 5,
                ReviewsCount = 8
            };
        }
        finally
        {
            isLoading = false;
        }
    }

    private async Task SaveProfile()
    {
        // TODO: Call API to save profile
        Console.WriteLine("Profile saved!");
    }

    private class ProfileViewModel
    {
        public string FirstName { get; set; } = "";
        public string LastName { get; set; } = "";
        public string DisplayName { get; set; } = "";
        public string Email { get; set; } = "";
        public string PhoneNumber { get; set; } = "";
        public string Address { get; set; } = "";
        public string? AvatarUrl { get; set; }
        public int OrdersCount { get; set; }
        public int WishlistCount { get; set; }
        public int ReviewsCount { get; set; }
    }
}

<style>
    .profile-container { max-width: 600px; margin: 0 auto; }
    .profile-header {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        padding: 1.5rem;
        background: linear-gradient(135deg, #6200ea, #3700b3);
        color: white;
        border-radius: 12px;
        margin-bottom: 1.5rem;
    }
    .avatar img {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        border: 3px solid white;
    }
    .profile-info h2 { margin: 0; }
    .profile-info p { margin: 0.25rem 0 0; opacity: 0.9; }

    .profile-form {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .form-group { margin-bottom: 1rem; }
    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
    }
    .form-actions { margin-top: 1.5rem; }

    .profile-stats {
        display: flex;
        justify-content: space-around;
        margin-top: 1.5rem;
        padding: 1rem;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .stat-item { text-align: center; }
    .stat-value {
        display: block;
        font-size: 1.5rem;
        font-weight: bold;
        color: #6200ea;
    }
    .stat-label { color: #666; font-size: 0.9rem; }
</style>
